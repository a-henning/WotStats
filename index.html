<html ng-app="wotApp">
<head>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.25/angular.min.js"></script>
	<script src="expected_values_service.js"></script>
	<script src="wn8_service.js"></script>
	<script src="app.js"></script>
</head>
<body ng-controller="PlayerController">

	<form ng-submit="searchPlayer()">
		Player name: <input type="text" ng-model="playerName">
		<input type="submit">
	</form>
	<div ng-if="playerNotFound === false">
		<table border="1">
			<tr>
				<th></th>
				<th>Nickname</th>
			</tr>
			<tr ng-repeat="player in playerSearchList.data">
				<td>{{$index + 1}}</td>
				<td>
					<a href ng-click="getPlayerRatings(player.account_id)">{{player.nickname}}</a>
				</td>
			</tr>
		</table>
	</div>
	<div ng-if="playerNotFound === true">
		<label>
			Player not found.
		</label>
	</div>
	<div ng-show="playerRatingsFound">
		<h1>Ratings</h1>
		Time period: <select ng-options="period as period for period in periods" ng-model="chosenPeriod" ng-change="getPlayerRatings()"></select>
		day(s)
		<table border="1">
			<tr>
				<th></th>
				<th>Value</th>
				<th>Rank</th>
				<th>Delta</th>
			</tr>
			<tr ng-repeat="(key, stat) in playerStats" ng-show="stat.value || stat.rank || stat.rank_delta">
				<td><strong>{{key}}</strong></td>
				<td>{{stat.value}}</td>
				<td>{{stat.rank | number:0}}</td>
				<td>{{stat.rank_delta | number:0}}</td>
			</tr>
		</table>
		<hr>
		<h1>WN8</h1>
		<h2>{{overallWn8 | number:2}}</h2>
		<hr>
		<h1>Vehicles</h1>
		<table border="1">
			<tr>
				<th></th>
				<th><a href ng-click="sort('name')">Tank name</a></th>
				<th><a href ng-click="sort('all.battles')">Battles</a></th>
				<th><a href ng-click="sort('winrate')">Winrate</a></th>
				<th><a href ng-click="sort('level')">Tier</a></th>
				<th><a href ng-click="sort('mark_of_mastery')">Mark of Mastery</a></th>
				<th><a href ng-click="sort('average_damage')">Average damage</a></th>
				<th><a href ng-click="sort('average_xp')">Average XP</a></th>
				<th><a href ng-click="sort('max_xp')">Maximum XP</a></th>
				<th><a href ng-click="sort('wn8')">WN8</a></th>
			</tr>
			<tr ng-repeat="tank in playerTanks | orderBy:sortCriteria:sortReverse" ng-if="tank.all.battles">
				<td>{{$index + 1}}</td>
				<td>{{tank.name}}</td>
				<td>{{tank.all.battles}}</td>
				<td>{{tank.winrate | number:2}}%</td>
				<td>{{tank.level}}</td>
				<td>{{getMasteryMarkById(tank.mark_of_mastery)}}</td>
				<td>{{tank.average_damage | number:0}}</td>
				<td>{{tank.average_xp | number:0}}</td>
				<td>{{tank.max_xp}}</td>
				<td>{{tank.wn8 | number:0}}</td>
			</tr>
		</table>
	</div>
</body>
</html>